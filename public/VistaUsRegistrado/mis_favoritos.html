<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Mis Favoritos</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
</head>
<body class="bg-light">
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
        <div class="container">
            <a class="navbar-brand fw-bold" href="homeUsRegistrado.html">RecetÃ¡stico</a>
            <div class="collapse navbar-collapse">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item"><a class="nav-link" href="homeUsRegistrado.html">Inicio</a></li>
                    <li class="nav-item"><a class="nav-link" href="recetas.html">Ver Recetas</a></li>
                    <li class="nav-item"><a class="nav-link active" href="#">Favoritos</a></li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container my-5">
        <h2 class="text-danger mb-4"><i class="bi bi-heart-fill"></i> Mis Recetas Favoritas</h2>
        <div id="fav-grid" class="row g-4"></div>
        <div id="empty-msg" class="text-center mt-5" style="display:none;">
            <h3>No tienes favoritos aÃºn ðŸ’”</h3>
            <a href="recetas.html" class="btn btn-primary mt-3">Ir a Explorar</a>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', async () => {
            const token = localStorage.getItem('token');
            if(!token) window.location.href = '../Vistavisitante/login.html';

            const res = await fetch('/api/users/favorites', { headers: {'x-auth-token': token}});
            const favs = await res.json();

            if(favs.length === 0) {
                document.getElementById('empty-msg').style.display = 'block';
            } else {
                document.getElementById('fav-grid').innerHTML = favs.map(r => `
                    <div class="col-md-4">
                        <div class="card h-100 border-0 shadow-sm">
                            <img src="${r.imageUrl || 'https://via.placeholder.com/400'}" class="card-img-top" style="height:200px; object-fit:cover;">
                            <div class="card-body">
                                <h5>${r.titulo}</h5>
                                <p class="small text-muted">${r.descripcion.substring(0,60)}...</p>
                                <a href="detalle_receta.html?id=${r._id}" class="btn btn-outline-danger w-100">Ver</a>
                            </div>
                        </div>
                    </div>
                `).join('');
            }
        });
    </script>
</body>
</html>